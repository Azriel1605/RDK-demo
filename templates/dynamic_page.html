{% extends "base.html" %}

{%block head%}

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

{% endblock %}

{% block title %}Page {{ page_num }} - Flask Warm App{% endblock %}

{% block content %}
<div class="card">
    <div class="text-center" style="margin-bottom: 2rem;">
        <h2 style="color: #8d6e63; font-size: 2rem;">
            {% if page_num == 1 %}📈 Keluarga PUS
            {% elif page_num == 2 %}📉 Keluarga dengan status Ibu Hamil
            {% elif page_num == 3 %}📋 Keluarga yang memiliki Balita
            {% elif page_num == 4 %}📊 Keluarga yang memiliki Remaja
            {% elif page_num == 5 %}📌 Keluarga yang memiliki Lanisa
            {% elif page_num == 6 %}📍 Kelompok Usia Balita
            {% elif page_num == 7 %}📎 Kelompok Usia Remaja
            {% elif page_num == 8 %}📑 Kelompok wanita usia subur
            {% elif page_num == 9 %}📄 Kelompok usia Lanisa
            {% elif page_num == 10 %}📃 Kelompok KB
            {% elif page_num == 11 %}📜 Keluarga dengan status Disabilitas
            {% else %}📰 Keluarga dengan status putus sekolah
            {% endif %}
        </h2>
        <p style="color: #6d4c41;">This is page {{ page_num }} of the data results section</p>
    </div>
    
    <div style="background: linear-gradient(135deg, #fff8e1, #f3e5ab); padding: 2rem; border-radius: 15px; margin-bottom: 2rem;">
        <h3 style="color: #8d6e63; margin-bottom: 1rem;">📋 Page Content</h3>
        <p style="color: #5d4037;">Laman ini menunjukkan Data Keluarga Pasangan Usia Subur (PUS)</p>

        <p style="color: #5d4037; line-height: 1.6;">
            Keluarga PUS adalah singkatan dari Keluarga Pasangan Usia Subur, yaitu keluarga yang terdiri dari suami dan istri yang berada dalam rentang usia subur, umumnya antara 15 sampai 49 tahun. Pasangan dalam kelompok ini dianggap memiliki potensi untuk memiliki anak, sehingga data Keluarga PUS penting untuk keperluan perencanaan program kependudukan, kesehatan reproduksi, serta pelayanan keluarga berencana (KB).
        </p>

        <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(255,255,255,0.7); border-radius: 10px;">
            {% if session.role == 'admin' or session.role == 'superadmin' %}
                <h4 id="pusCount1" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 1:</h4>
                <h4 id="pusCount2" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 2:</h4>
                <h4 id="pusCount3" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 3:</h4>
                <h4 id="pusCount4" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 4:</h4>
                <h4 id="pusCount5" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 5:</h4>
                <h4 id="pusCount6" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 6:</h4>
                <h4 id="pusCount7" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 7:</h4>
                <h4 id="pusCount8" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 8:</h4>
                <h4 id="pusCount9" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 9:</h4>
                <h4 id="pusCount10" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 10:</h4>
                <h4 id="pusCount11" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 11:</h4>
                <h4 id="pusCount12" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW 12:</h4>
                
                <script>
                fetch('/api/pus')
                .then(res => res.json())
                .then(data => {
                    const counts = data.recordsTotal;
                    for (let i = 1; i <= 12; i++) {
                    const el = document.getElementById(`pusCount${i}`);
                    if (el) {
                        el.textContent = `Banyaknya Keluarga PUS RW ${i}: ${counts[i] ?? 0}`;
                    }
                    }
                })
                .catch(error => {
                    console.error("Failed to fetch PUS counts:", error);
                });
                </script>

            {% else %}
                <h4 id="pusCount" style="color: #6d4c41; margin-bottom: 0.5rem;">Banyaknya Keluarga PUS RW {{session.role}}:</h4>
                <script>
                    fetch('/api/pus')
                    .then(res => res.json())
                    .then(data => {
                        const count = data.recordsTotal?.[0] ?? 0; // Get first item or fallback to 0
                        const el = document.getElementById("pusCount");
                        if (el) {
                            el.textContent = `Banyaknya Keluarga PUS RW {{session.role}}: ${count}`;
                        }
                    })
                    .catch(error => {
                        console.error("Failed to fetch PUS count:", error);
                    });
                </script>
            {% endif %}

            <!--<ul style="color: #5d4037; margin-left: 1.5rem;">
                <li>Display specific data tables or charts</li>
                <li>Show filtered results based on categories</li>
                <li>Implement different forms or input methods</li>
                <li>Add page-specific functionality</li>
            </ul> -->
            </script>
        </div>
        
    </div>

    <div style="background: linear-gradient(135deg, #fff8e1, #f3e5ab); padding: 2rem; border-radius: 15px; margin-bottom: 2rem;">
        {% if page_num == 1 %}
            <h1>Family Table</h1>
            <table id="familyTable" class="display", style="width:100%">
                <thead>
                <tr>
                    <th>KK</th>
                    <th>Address</th>
                    <th>RT</th>
                    <th>RW</th>
                </tr>
                </thead>
            </table>

            <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
            <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
            <script>
                $(document).ready(function () {
                    $('#familyTable').DataTable({
                        processing: true,
                        serverSide: true,
                        scrollX: true,
                        ajax: '/api/pus',
                        columns: [
                        { data: 'kk' },
                        { data: 'address' },
                        { data: 'rt' },
                        { data: 'rw' }
                        ]
                    });
                });
            </script>
        {% endif %}
    </div>
    
    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        {% if page_num > 1 %}
            <a href="{{ url_for('dynamic_page', page_num=page_num-1) }}" class="btn">⬅️ Previous Page</a>
        {% endif %}
        
        <a href="{{ url_for('hasil_data') }}" class="btn btn-primary">📊 Back to Hasil Data</a>
        
        {% if page_num < 12 %}
            <a href="{{ url_for('dynamic_page', page_num=page_num+1) }}" class="btn">Next Page ➡️</a>
        {% endif %}
    </div>
</div>
{% endblock %}